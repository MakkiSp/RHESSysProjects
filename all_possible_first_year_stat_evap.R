library(dplyr)
library(lubridate)


firstyear=function(a,b,c,d,e,an1){
  str1=readin_rhessys_output(a,g=0)
  str2=readin_rhessys_output(b,g=0)
  str3=readin_rhessys_output(c,g=0)
  str4=readin_rhessys_output(d,g=0)
  str5=readin_rhessys_output(e,g=0)
  tmp.1=subset(str1$bd,str1$bd$wy==an1)
  tmp.2=subset(str2$bd,str2$bd$wy==an1)
  tmp.3=subset(str3$bd,str3$bd$wy==an1)
  tmp.4=subset(str4$bd,str4$bd$wy==an1)
  tmp.5=subset(str5$bd,str5$bd$wy==an1)
  stream1=aggregate(tmp.1$et,by=list(tmp.1$wy),FUN=sum)
  stream2=aggregate(tmp.2$et,by=list(tmp.2$wy),FUN=sum)
  stream3=aggregate(tmp.3$et,by=list(tmp.3$wy),FUN=sum)
  stream4=aggregate(tmp.4$et,by=list(tmp.4$wy),FUN=sum)
  stream5=aggregate(tmp.5$et,by=list(tmp.5$wy),FUN=sum)
  pcp=aggregate(tmp.5$precip,by=list(tmp.5$wy),FUN=sum)
  kk=cbind(pcp,stream1$x,stream2$x,stream3$x,stream4$x,stream5$x)
  colnames(kk)=c("year","pcp","base","thin75","thin50","thin25","thin95")
  kk
}


setwd("D:/arnas/out/results_thin_multiplier2001/")
thin01=firstyear("sen1","sen5","sen9","sen13","sen17",2002)
setwd("D:/arnas/out/results_thin_multiplier2002/")
thin02=firstyear("sen1","sen5","sen9","sen13","sen17",2003)
setwd("D:/arnas/out/results_thin_multiplier2003/")
thin03=firstyear("sen1","sen5","sen9","sen13","sen17",2004)
setwd("D:/arnas/out/results_thin_multiplier2004/")
thin04=firstyear("sen1","sen5","sen9","sen13","sen17",2005)
setwd("D:/arnas/out/results_thin_multiplier2005/")
thin05=firstyear("sen1","sen5","sen9","sen13","sen17",2006)
setwd("D:/arnas/out/results_thin_multiplier2006/")
thin06=firstyear("sen1","sen5","sen9","sen13","sen17",2007)
setwd("D:/arnas/out/results_thin_multiplier2007/")
thin07=firstyear("sen1","sen5","sen9","sen13","sen17",2008)
setwd("D:/arnas/out/results_thin_multiplier2008/")
thin08=firstyear("sen1","sen5","sen9","sen13","sen17",2009)
setwd("D:/arnas/out/results_thin_multiplier2009/")
thin09=firstyear("sen1","sen5","sen9","sen13","sen17",2010)
setwd("D:/arnas/out/results_thin_multiplier2010/")
thin10=firstyear("sen1","sen5","sen9","sen13","sen17",2011)
setwd("D:/arnas/out/results_thin_multiplier2011/")
thin11=firstyear("sen1","sen5","sen9","sen13","sen17",2012)
setwd("D:/arnas/out/results_thin_multiplier2012/")
thin12=firstyear("sen1","sen5","sen9","sen13","sen17",2013)
setwd("D:/arnas/out/results_thin_multiplier2013/")
thin13=firstyear("sen1","sen5","sen9","sen13","sen17",2014)
setwd("D:/arnas/out/results_thin_multiplier2014/")
thin14=firstyear("sen1","sen5","sen9","sen13","sen17",2015)
setwd("D:/arnas/out/results_thin_multiplier2015/")
thin15=firstyear("sen1","sen5","sen9","sen13","sen17",2016)
setwd("D:/arnas/out/results_thin_multiplier2016/")
thin16=firstyear("sen1","sen5","sen9","sen13","sen17",2017)

thin=rbind(thin01,thin02,thin03,thin04,thin05,thin06,thin07,thin08,thin09,thin10,thin11,thin12,thin13,thin14,thin15,thin16)

################################################
################################################   
################################################

setwd("D:/arnas/out/results_thin_multiplier2001/")
thin01=firstyear("sen2","sen6","sen10","sen14","sen18",2002)
setwd("D:/arnas/out/results_thin_multiplier2002/")
thin02=firstyear("sen2","sen6","sen10","sen14","sen18",2003)
setwd("D:/arnas/out/results_thin_multiplier2003/")
thin03=firstyear("sen2","sen6","sen10","sen14","sen18",2004)
setwd("D:/arnas/out/results_thin_multiplier2004/")
thin04=firstyear("sen2","sen6","sen10","sen14","sen18",2005)
setwd("D:/arnas/out/results_thin_multiplier2005/")
thin05=firstyear("sen2","sen6","sen10","sen14","sen18",2006)
setwd("D:/arnas/out/results_thin_multiplier2006/")
thin06=firstyear("sen2","sen6","sen10","sen14","sen18",2007)
setwd("D:/arnas/out/results_thin_multiplier2007/")
thin07=firstyear("sen2","sen6","sen10","sen14","sen18",2008)
setwd("D:/arnas/out/results_thin_multiplier2008/")
thin08=firstyear("sen2","sen6","sen10","sen14","sen18",2009)
setwd("D:/arnas/out/results_thin_multiplier2009/")
thin09=firstyear("sen2","sen6","sen10","sen14","sen18",2010)
setwd("D:/arnas/out/results_thin_multiplier2010/")
thin10=firstyear("sen2","sen6","sen10","sen14","sen18",2011)
setwd("D:/arnas/out/results_thin_multiplier2011/")
thin11=firstyear("sen2","sen6","sen10","sen14","sen18",2012)
setwd("D:/arnas/out/results_thin_multiplier2012/")
thin12=firstyear("sen2","sen6","sen10","sen14","sen18",2013)
setwd("D:/arnas/out/results_thin_multiplier2013/")
thin13=firstyear("sen2","sen6","sen10","sen14","sen18",2014)
setwd("D:/arnas/out/results_thin_multiplier2014/")
thin14=firstyear("sen2","sen6","sen10","sen14","sen18",2015)
setwd("D:/arnas/out/results_thin_multiplier2015/")
thin15=firstyear("sen2","sen6","sen10","sen14","sen18",2016)
setwd("D:/arnas/out/results_thin_multiplier2016/")
thin16=firstyear("sen1","sen5","sen9","sen13","sen17",2017)

thin.warm=rbind(thin01,thin02,thin03,thin04,thin05,thin06,thin07,thin08,thin09,thin10,thin11,thin12,thin13,thin14,thin15,thin16)

evap=cbind(thin,thin.warm)
setwd("D:/arnas/out/Totales/")

write.table(evap,"first_year_stat_evap.csv",sep=";",dec=",",col.names = T,row.names = F)



