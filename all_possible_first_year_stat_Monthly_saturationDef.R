library(dplyr)
library(lubridate)

monthlysat=function(data){
  #data=subset(scen$bd,scen$bd$date>="2007-10-01" & scen$bd$date<="2008-09-30")
  xx=data %>% group_by(date=floor_date(date, "month")) %>%
    summarize(stream=mean(sat_def))
  xx=as.data.frame(xx)
  xx$years=year(xx$date)
  xx$months=month(xx$date)
  xx$stream
}

monthlyrz=function(data){
  #data=subset(scen$bd,scen$bd$date>="2007-10-01" & scen$bd$date<="2008-09-30")
  xx=data %>% group_by(date=floor_date(date, "month")) %>%
    summarize(stream=mean(rz_storage))
  xx=as.data.frame(xx)
  xx$years=year(xx$date)
  xx$months=month(xx$date)
  xx$stream
}
monthlyuns=function(data){
  #data=subset(scen$bd,scen$bd$date>="2007-10-01" & scen$bd$date<="2008-09-30")
  xx=data %>% group_by(date=floor_date(date, "month")) %>%
    summarize(stream=mean(unsat_stor))
  xx=as.data.frame(xx)
  xx$years=year(xx$date)
  xx$months=month(xx$date)
  xx$stream
}
streams=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){
  flow.1=monthlysat(a)-monthlyrz(a)-monthlyuns(a)
  flow.2=monthlysat(b)-monthlyrz(b)-monthlyuns(b)
  flow.3=monthlysat(c)-monthlyrz(c)-monthlyuns(c)
  flow.4=monthlysat(d)-monthlyrz(d)-monthlyuns(d)
  flow.5=monthlysat(e)-monthlyrz(e)-monthlyuns(e)
  flow.6=monthlysat(f)-monthlyrz(f)-monthlyuns(f)
  flow.7=monthlysat(g)-monthlyrz(g)-monthlyuns(g)
  flow.8=monthlysat(h)-monthlyrz(h)-monthlyuns(h)
  flow.9=monthlysat(i)-monthlyrz(i)-monthlyuns(i)
  flow.10=monthlysat(j)-monthlyrz(j)-monthlyuns(j)
  flow.11=monthlysat(k)-monthlyrz(k)-monthlyuns(k)
  flow.12=monthlysat(l)-monthlyrz(l)-monthlyuns(l)
  flow.13=monthlysat(m)-monthlyrz(m)-monthlyuns(m)
  flow.14=monthlysat(n)-monthlyrz(n)-monthlyuns(n)
  flow=cbind(flow.1,flow.2,flow.3,flow.4,flow.5,flow.6,flow.7,flow.8,flow.9,flow.10,flow.11,flow.12,flow.13,flow.14)
  tmp=NULL
  for (i in 1:12){
    tmp[i]=mean(flow[i,])
  }
  tmp
}


setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen1",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen1",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

base=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)

setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen5",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen5",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen75=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)



setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen9",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen9",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen50=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen13",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen13",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen25=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen17",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen17",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen95=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


plot(base,type="l",ylim=c(200,500),xaxt = "n")
axis(1, at=1:12, labels=c("Oct.","Nov.","Dec.","Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep."))
lines(scen95,col="red")
lines(scen75,col="green")
lines(scen50,col="orange")
lines(scen25,col="blue")


############################################### WARM

setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen2",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen2",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)
base.warm=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)

setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen6",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen6",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen75.warm=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)



setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen10",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen10",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen50.warm=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen14",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen14",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen25.warm=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


setwd("D:/arnas/out/results_thin_multiplier2001/")
str1=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2002/")
str2=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2003/")
str3=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2004/")
str4=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2005/")
str5=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2006/")
str6=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2007/")
str7=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2008/")
str8=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2009/")
str9=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2010/")
str10=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2013/")
str11=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2014/")
str12=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2015/")
str13=readin_rhessys_output("sen18",g=0)
setwd("D:/arnas/out/results_thin_multiplier2016/")
str14=readin_rhessys_output("sen18",g=0)

tmp.1=subset(str1$bd,str1$bd$wy==2002)
tmp.2=subset(str2$bd,str2$bd$wy==2003)
tmp.3=subset(str3$bd,str3$bd$wy==2004)
tmp.4=subset(str4$bd,str4$bd$wy==2005)
tmp.5=subset(str5$bd,str5$bd$wy==2006)
tmp.6=subset(str6$bd,str6$bd$wy==2007)
tmp.7=subset(str7$bd,str7$bd$wy==2008)
tmp.8=subset(str8$bd,str8$bd$wy==2009)
tmp.9=subset(str9$bd,str9$bd$wy==2010)
tmp.10=subset(str10$bd,str10$bd$wy==2013)
tmp.11=subset(str11$bd,str11$bd$wy==2014)
tmp.12=subset(str12$bd,str12$bd$wy==2015)
tmp.13=subset(str13$bd,str13$bd$wy==2016)
tmp.14=subset(str14$bd,str14$bd$wy==2017)

scen95.warm=streams(tmp.1,tmp.2,tmp.3,tmp.4,tmp.5,tmp.6,tmp.7,tmp.8,tmp.9,tmp.10,tmp.11,tmp.12,tmp.13,tmp.14)


plot(base.warm,type="l",ylim=c(200,500),xaxt = "n")
axis(1, at=1:12, labels=c("Oct.","Nov.","Dec.","Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep."))
lines(scen95.warm,col="red")
lines(scen75.warm,col="green")
lines(scen50.warm,col="orange")
lines(scen25.warm,col="blue")


setwd("D:/arnas/out/Totales/")
matrice=cbind(base,scen95,scen75,scen50,scen25,base.warm,scen95.warm,scen75.warm,scen50.warm,scen25.warm)

colnames(matrice)=c("base","th95","th75","th50","th25","base.warm","th95.warm","th75.warm","th50.warm","th25.warm")
write.table(matrice,"Monthlysat_Def.stat.firstyear.csv",sep=";",dec=",",col.names = T,row.names = F)

